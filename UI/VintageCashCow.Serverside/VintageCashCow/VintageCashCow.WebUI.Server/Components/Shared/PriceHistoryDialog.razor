@using MudBlazor
@using VintageCashCow.WebUI.Server.Models
@using System.Globalization

<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h5">
            <MudIcon Icon="@Icons.Material.Filled.History" Class="mr-2" />
            Price History for @(ProductHistory?.Name ?? "Product")
        </MudText>
    </TitleContent>

    <DialogContent>
        @if (ProductHistory is null)
        {
            <MudAlert Severity="Severity.Warning">
                No price history available
            </MudAlert>
        }
        else if (ProductHistory.PriceHistory?.Count == 0)
        {
            <MudAlert Severity="Severity.Info">
                No price changes have been recorded yet
            </MudAlert>
        }
        else
        {
            <MudTable Items="@ProductHistory.PriceHistory"
                      Hover="true"
                      Striped="true"
                      Dense="true"
                      Elevation="0"
                      FixedHeader="true"
                      Height="400px">
                <HeaderContent>
                    <MudTh>Date & Time</MudTh>
                    <MudTh>Price</MudTh>
                </HeaderContent>
                <RowTemplate Context="history">
                    <MudTd DataLabel="Date">
                        <MudText Typo="Typo.body2">
                            @history.Date.ToString("g")
                        </MudText>
                        <MudText Typo="Typo.caption" Color="Color.Secondary">
                            @history.Date.ToString("dddd")
                        </MudText>
                    </MudTd>
                    <MudTd DataLabel="Price">
                        <MudText Typo="Typo.body1" Color="Color.Primary">
                            <strong>@history.Price.ToString("C", _gbpCulture)</strong>
                        </MudText>
                    </MudTd>
                </RowTemplate>
                <PagerContent>
                    <MudTablePager PageSizeOptions="new int[] { 5, 10, 25, 50 }" />
                </PagerContent>
            </MudTable>
        }
    </DialogContent>

    <DialogActions>
        <MudButton OnClick="Close"
                   Variant="Variant.Filled"
                   Color="Color.Primary"
                   StartIcon="@Icons.Material.Filled.Close">
            Close
        </MudButton>
    </DialogActions>
</MudDialog>

